define("mod_oublog/statsupdate",["exports","core/pending","core_form/changechecker"],(function(_exports,_pending,FormChangeChecker){var e;
/**
   * Moodle renderer used to display special elements of the blog
   *
   * @module    mod_oublog/statusupdate
   * @copyright 2024 The Open University
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   **/function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function(e){return e?t:r})(e)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_pending=(e=_pending)&&e.__esModule?e:{default:e},FormChangeChecker=function(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&{}.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}(FormChangeChecker);_exports.init=container_class=>{let content=document.querySelector(".oublog_statsview_content_"+container_class);if(content){const form=content.querySelector("form.mform");form.addEventListener("submit",(event=>{event.preventDefault();const pendingPromiseAjax=new _pending.default("mod_oublog/statsupdate");let div=document.createElement("div");div.classList.add("ajaxworking");let pos=event.target.querySelector("div.row.fitem:last-child div:last-child");pos&&pos.appendChild(div);const id=form.querySelector("input[name=id]"),currentcmid=form.querySelector("input[name=currentcmid]");let args={type:form.querySelector("input[name=type]").value,id:0,currentcmid:0};id&&(args.id=id.value),currentcmid&&(args.currentcmid=currentcmid.value);const formData=new FormData(form);fetch("stats_update.php",{method:"POST",body:formData}).then((response=>response.json())).then((response=>{statsupdate_killspinner(!1);try{if(response.containerclass&&!content.classList.contains(response.containerclass)&&(content=document.querySelector("."+response.containerclass)),response.subtitle&&response.subtitleclass){const subtitle=content.querySelector("."+response.subtitleclass);subtitle&&(subtitle.innerHTML=response.subtitle)}if(response.info&&response.infoclass){const info=content.querySelector("."+response.infoclass);info&&(info.innerHTML=response.info)}if((response.content||""===response.content)&&response.contentclass){const innercontent=content.querySelector("."+response.contentclass);innercontent&&(innercontent.innerHTML=response.content)}}catch(e){return statsupdate_killspinner(!0),console.log(e),void pendingPromiseAjax.resolve()}pendingPromiseAjax.resolve()})).catch((()=>{statsupdate_killspinner(!0),pendingPromiseAjax.resolve()}));const statsupdate_killspinner=submit=>{const spinner=form.querySelector(".ajaxworking");spinner&&spinner.remove(!0),submit&&(FormChangeChecker.disableAllChecks(),form.submit())}}))}}}));

//# sourceMappingURL=statsupdate.min.js.map